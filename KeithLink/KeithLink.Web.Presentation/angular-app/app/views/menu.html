<!-- Mobile Sidebar -->
<div id="sp-nav" ng-swipe-right="$spMenu.hide()" class="sidebar sidebar-mobile" style="display:none;">
 <div class="person-info user-info" ng-click="displayUserMenu = !displayUserMenu">
    <div class="person-info__section"><img ng-src="{{userProfile.imageurl}}" alt=""></div>
    <div class="person-info__section person-info__details">
      <div>
        <span class="text-white user-info__name">{{userProfile.displayname}}</span>
      </div>
      <div>
        <span class="user-info__job-title text-capitalize">{{userProfile.rolename}}</span>
      </div>
    </div>
    <div class="person-info__section text-white">
      <span class="icon-arrow-down6"></span>
    </div>
  </div>

  <nav class="sidebar-nav">
    <ul class="list-unstyled">

      <div ng-show="displayUserMenu">
        <button
          class="btn-no-style"
          ng-click="$spMenu.hide()"
          ui-sref="menu.accountdetails">
          <li>Account Settings</li>
        </button>
        <button
          class="btn-no-style"
          ng-click="$spMenu.hide(); openTechnicalSupportModal()">
          <li>Technical Support</li>
        </button>
        <button
          class="btn-no-style"
          ng-click="logout()">
          <li>Sign Out</li>
        </button>
        <!-- <a> -->
          <li>
            <!-- <div class="select-div"> -->
              <select class="input-lg form-control" ng-show="!isOrderEntryCustomer" ng-options="branch.id as branch.name for branch in branches" ng-model="selectedUserContext" ng-change="changeBranch()"></select>
            <!-- </div> -->

            <div ui-select2="customerSelectOptions" ng-if="isOrderEntryCustomer" ng-change="changeCustomerLocation(selectedUserContext)" ng-model="selectedUserContext" data-placeholder="Select a customer..." style="width:100%;">
            </div>
          </li>
        <!-- </a> -->
      </div>

      <!-- MOBILE MENU -->
      <div ng-click="$spMenu.hide()">
        <button
          class="btn-no-style"
          ng-disabled="!isOrderEntryCustomer"
          ui-sref="menu.home"
          ui-sref-active="is-selected" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-house"></span></div>
            Home
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canCreateOrders"
          ui-sref="menu.order"
          ng-class="{'is-selected': $state.includes('menu.order') || $state.includes('menu.orderitems')}" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-clipboard"></span></div>
            Order History
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canBrowseCatalog"
          ui-sref="menu.catalog.home"
          ng-class="{'is-selected': $state.includes('menu.catalog')}" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-book2"></span></div>
            Product Catalog
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canPayInvoices"
          ui-sref="blank"
          ui-sref-active="is-selected" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-pie"></span></div>
            Reports
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canPayInvoices"
          ui-sref="menu.invoice"
          ui-sref-active="is-selected" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-dollar"></span></div>
            Invoices
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canManageLists"
          ui-sref="menu.lists.items({listId: 0})"
          ng-class="{'is-selected': $state.includes('menu.lists')}" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-text"></span></div>
            My Lists
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canCreateOrders"
          ui-sref="menu.addtoorder.items({ })"
          ng-class="{'is-selected': $state.includes('menu.addtoorder')}" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-add-to-list"></span></div>
            Add to Order
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-if="canManageAccount"
          ui-sref="menu.admin.accountadmin"
          ng-class="{'is-selected': $state.includes('menu.admin.accountadmin')}">
          <li>
            <div class="sidebar-nav__icon"><span class="icon-cog"></span></div>
            Admin
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!isOrderEntryCustomer"
          ui-sref="menu.notifications"
          ui-sref-active="is-selected" >
          <li>
            <div class="sidebar-nav__icon"><span class="icon-bell"></span></div>
            <span ng-if="userBar.userNotificationsCount.unread && userBar.userNotificationsCount.unread > 0" class="badge">{{userBar.userNotificationsCount.unread}}</span>
            Notifications
          </li>
        </button>
      </div> <!-- END MOBILE MENU -->

    </ul>
  </nav>
  <div class="person-info sidebar-dsr" ng-if="isOrderEntryCustomer">
    <div class="person-info__section"><img ng-src="{{userProfile.salesRep.imageUrl}}" alt=""></div>
    <div class="person-info__section person-info__details">
      <span class="text-white">{{userProfile.salesRep.name}}</span>
      <a ng-href="{{'tel:' + userProfile.salesRep.phone}}" class="text-white">{{userProfile.salesRep.phone}}</a>
      <span><a class="text-uppercase" href="mailto:{{userProfile.salesRep.email}}">Email Me</a></span>
    </div>
  </div>
  <div ng-if="isOrder" class="sidebar-actions text-center">
    <button class="btn btn-primary">View Your Order</button>
  </div>
</div> <!-- end Mobile Sidebar -->

<div id="sp-page" ng-swipe-left="$spMenu.hide()" ng-swipe-right="$spMenu.show()" class="desktop-wrapper">
  <!-- Desktop Sidebar -->

  <div class="sidebar sidebar-desktop hidden-print hidden-sm hidden-xs">
    <div class="sidebar-logo text-center">
      <img src="images/bek-logo.png" alt="logo" />
    </div>

    <!-- DESKTOP MENU -->
    <nav class="sidebar-nav">
      <ul class="list-unstyled">
        <button
          class="btn-no-style"
          ng-disabled="!isOrderEntryCustomer"
          ui-sref="menu.home"
          ui-sref-active="is-selected" >
          <li>
            <span class="icon-house sidebar-nav__icon"></span>
            Home
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canCreateOrders"
          ui-sref="menu.order"
          ng-class="{'is-selected': $state.includes('menu.order') || $state.includes('menu.orderitems')}" >
          <li>
            <span class="icon-clipboard sidebar-nav__icon"></span>
            Order History
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canBrowseCatalog"
          ui-sref="menu.catalog.home"
          ng-class="{'is-selected': $state.includes('menu.catalog')}" >
          <li>
            <span class="icon-book2 sidebar-nav__icon"></span>
            Product Catalog
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canPayInvoices"
          ui-sref="blank"
          ui-sref-active="is-selected" >
          <li>
            <span class="icon-pie sidebar-nav__icon"></span>
            Reports
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canPayInvoices"
          ui-sref="menu.invoice"
          ui-sref-active="is-selected" >
          <li>
            <span class="icon-dollar sidebar-nav__icon"></span>
            Invoices
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canManageLists"
          ui-sref="menu.lists.items({listId: 0})"
          ng-class="{'is-selected': $state.includes('menu.lists')}" >
          <li>
            <span class="icon-text sidebar-nav__icon"></span>
            My Lists
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-disabled="!canCreateOrders"
          ui-sref="menu.addtoorder.items({ })"
          ng-class="{'is-selected': $state.includes('menu.addtoorder')}" >
          <li>
            <span class="icon-add-to-list sidebar-nav__icon"></span>
            Add to Order
          </li>
        </button>
        <button
          class="btn-no-style"
          ng-if="canManageAccount"
          ui-sref="menu.admin.accountadmin"
          ng-class="{'is-selected': $state.includes('menu.admin.accountadmin')}" >
          <li>
            <span class="icon-cog sidebar-nav__icon"></span>
            Admin
          </li>
        </button>
      </ul>
    </nav> <!-- END DESKTOP MENU -->

    <div class="sidebar-dsr text-center" ng-if="isOrderEntryCustomer">
      <p>Your Sales Rep</p>
      <img ng-show="userProfile.salesRep.imageUrl" ng-src="{{userProfile.salesRep.imageUrl}}" alt="dsr image" />
      <p class="contact-info">
        <span>{{userProfile.salesRep.name}}</span>
        <span>{{userProfile.salesRep.phone}}</span>
      </p>
      <a class="text-uppercase" href="mailto:{{userProfile.salesRep.email}}">Email Me</a>
    </div>
    <div class="text-center sidebar-meta">
      <span>Copyright 2014 Ben E. Keith</span>
      <a href="#">benekeith.com</a>
    </div>
  </div>

  <div class="row page-content">
    <div class="col-sm-12">
      <div class="row hidden-print user-bar-mobile visible-xs visible-sm">
        <ul class="left-mobile-menu" style="float: left;">
          <a ng-hide="$state.current.name === 'menu.home'" ng-click="backfunction()"><li><span class="icon-back"></span></li></a>
          <a ng-click="$spMenu.toggle()"><li><span class="icon-list2"></span></li></a>
        </ul>
        <ul class="right-mobile-menu" style="float: right;">
          <a ng-click="isMobileSearchBarDisplayed = !isMobileSearchBarDisplayed"><li><span class="icon-search"></span></li></a>
          <a ui-sref="menu.cart.items"><li><span class="icon-truck"></span></li></a>
        </ul>
        <img src="images/bek-logo.png" alt="logo" class="logo-mobile" />
      </div>

      <div class="row user-bar hidden-print" ng-init="isMobileSearchBarDisplayed = true" ng-class="{ 'hide-searchbar' : isMobileSearchBarDisplayed }">
        <div class="col-md-4 hidden-sm hidden-xs">
          <!-- <div class="select-div"> -->
            <select class="input-lg form-control" ng-show="!isOrderEntryCustomer" ng-options="branch.id as branch.name for branch in branches" ng-model="selectedUserContext" ng-change="changeBranch()"></select>
          <!-- </div> -->

          <div ui-select2="customerSelectOptions" ng-if="isOrderEntryCustomer" ng-change="changeCustomerLocation(selectedUserContext)" ng-model="selectedUserContext" data-placeholder="Select a customer..." style="width:100%;">
          </div>

        </div>
        <div class="col-md-4">
          <form name="universalSearchForm" novalidate ng-if="canBrowseCatalog">
            <div class="input-group input-group-lg">
              <input required ng-minlength="3" ng-model="userBar.universalSearchTerm" type="text" class="form-control" placeholder="Search by keyword">
              <span class="input-group-btn">
                <button ui-sref="menu.catalog.products.list({ type: 'search', id: userBar.universalSearchTerm })" ng-disabled="universalSearchForm.$invalid" class="btn-default btn" type="submit"><span class="glyphicon glyphicon-search"></span></button>
              </span>
            </div>
          </form>
        </div>
        <div class="col-md-4 hidden-sm hidden-xs text-right nowrap">
          <div>
            <a ng-if="isOrderEntryCustomer" ui-sref="menu.notifications" class="text-regular"><span class="user-bar__notification">
              <span class="icon-bell"></span>
              <span class="badge" ng-if="userBar.userNotificationsCount.unread && userBar.userNotificationsCount.unread > 0">{{userBar.userNotificationsCount.unread}}</span>
            </span></a>
            <div class="person-info user-info" ng-mouseenter="displayUserMenu = true" ng-mouseleave="displayUserMenu = false">
              <div class="person-info__section person-info__details">
                <span class="user-info__name">{{userProfile.displayname}}</span>
                <span class="user-info__job-title text-capitalize">{{userProfile.rolename}}</span>
                <div class="user-info__menu btn-group-vertical" ng-show="displayUserMenu">
                  <button class="btn btn-lg btn-default" ui-sref="menu.accountdetails">Account Settings</button>
                  <button class="btn btn-lg btn-default" ng-click="openTechnicalSupportModal()">Technical Support</button>
                  <button class="btn btn-lg btn-default" ng-click="logout()">Sign Out</button>
                </div>
              </div>
              <div class="person-info__section">
                <span class="icon-arrow-down5"></span>
              </div>
              <div class="person-info__section" ng-show="userProfile.imageUrl"><img ng-src="{{userProfile.imageUrl}}" alt=""></div>
            </div>
          </div>
        </div>
      </div>

      <div class="row user-bar hidden-print" ng-show="showLoginForm">
        <div class="col-xs-12 text-right">

        </div>
      </div>

      <div class="view" ui-view="">
          <p loading-spinner="true"></p>
      </div>
    </div>
  </div>
</div>
