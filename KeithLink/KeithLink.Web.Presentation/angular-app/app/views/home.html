<!-- Featured Items -->
<div class="row">
    <div loading-spinner="loadingPromoItems" ng-show="loadingPromoItems"></div>
    <p class="col-xs-12" ng-show="!promoMessage && promoItems && promoItems.length === 0">There are no promos to display at this time.</p>
    <p class="col-xs-12 text-red" ng-show="promoMessage">{{promoMessage}}</p>

    <div ng-if="promoItems.length > 0 && !loadingPromoItems">

      <div class="page-header-bar-home">
        <div featured-item-carousel="promoItems" template="{{'views/featuredItemTemplates/featureditem.html'}}"></div>
      </div>

    </div>
</div>

<div ng-if="systemUpdates.length > 0" ng-init="showNotification(systemUpdates[0])"></div>
<!-- <ng-include src="'views/globalmessage.html'"></ng-include> -->
<div class="page-content">
  <div class="row">
    <div class="col-md-4 col-md-push-8">
      <!-- Account Summary -->
      <div class="info-box" ng-class="{ 'account-summary-info': canViewOrders}" ng-if="canViewInvoices">
        <a 
            ng-if="canViewInvoices"
            ui-sref="menu.invoice" 
            class="pull-right btn btn-primary btn-lg" 
            analytics-on 
            analytics-category="Homepage-Pay-Invoice" 
            analytics-event="Pay Invoice Button">
            <span ng-hide="selectedUserContext.customer.balance.totalbalance == 0 || hidePayNowButton">Pay Now</span>
            <span ng-show="hidePayNowButton" >View Invoices</span>
        </a>
        <h4><strong>Account Balance</strong></h4>
        <div loading-spinner="loadingAccountBalance"></div>
        <div ng-show="!loadingAccountBalance">
          <p class="currency-value">
            {{selectedUserContext.customer.balance.totalbalance || 0 | currency}}
          </p>
          <p class="">Your Terms: {{selectedUserContext.customer.termdescription || 'N/A'}}</p>
          <div class="row text-center">
            <div class="balance__term--amount">
              <strong>Current</strong> {{selectedUserContext.customer.balance.currentbalance | currency}}
            </div>
            <div class="balance__term--amount">
              <strong>Past Due</strong>
              <div ng-class="{ 'text-red': selectedUserContext.customer.balance.pastdue > 0 }">
                <strong>{{selectedUserContext.customer.balance.pastdue | currency}}</strong>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="info-box account-summary__graph hidden-xs hidden-sm" style="padding-left: 0; padding-bottom: 0;" ng-controller="OrderSummaryGraphController" ng-if="canViewOrders">
        <div style="margin-left: 15px;">
          <h4 class="no-margin-top"><strong>Order Summary Last 6 Months</strong></h4>
          <div loading-spinner="loadingOrderGraph"></div>
          <span class="text-red" ng-show="ordersGraphMessage">{{ordersGraphMessage}}</span>
        </div>
        <div id="chart_div" style="height:140px;width:100%;"></div>
      </div>
      <!-- end Account Summary -->
      <!-- Featured Items -->
      <!-- <div class="row">
        <div class="col-sm-12">
          <h3>Latest From Ben E. Keith</h3>
          <div loading-spinner="loadingPromoItems" ng-show="loadingPromoItems"></div>
          <p class="col-xs-12" ng-show="!promoMessage && marketingPromoItems && marketingPromoItems.length === 0">There are no promos to display at this time.</p>
          <p class="col-xs-12 text-red" ng-show="promoMessage">{{promoMessage}}</p>

          <div ng-if="marketingPromoItems.length > 0 && !loadingPromoItems">

            <div class="col-xs-12">
              <div featured-item-carousel="marketingPromoItems" marketing="true" template="{{'views/featuredItemTemplates/featureditem.html'}}"></div>
            </div>

          </div>
        </div>
      </div> -->
    </div>

    <div class="col-md-8 col-md-pull-4" style="padding-top: 10px; padding-right: 0;">

        <div class="row" ng-if="canCreateOrders && cartHeaders && cartHeaders.length > 0 || canViewOrders && orders && orders.length > 0">
            <div class="col-lg-12">
              <tabset class="tabset tab-border">
                <tab heading="Pending Orders" ng-if="canCreateOrders && cartHeaders && cartHeaders.length > 0" class="text-center">
                  <h3 class="visible-print-block hidden-xs hidden-sm hidden-md hidden-lg">Pending Orders</h3>
                    <table class="table item-details__table table-striped-rows no-margin" style="table-layout: fixed;">
                      <tbody>
                        <tr>
                          <th>Cart ID</th>
                          <th class="hidden-xs">Cart Created</th>
                          <th>Ship Date</th>
                          <th>Item Count</th>
                          <th>Subtotal</th>
                        </tr>
                        <tr ng-repeat="cart in cartHeaders | orderBy:'createddate':true | limitTo: numCartsToDisplay">
                            <td><a ui-sref="menu.cart.items({cartId: cart.id})" class="order-col__number">{{cart.name}}</a></td>
                            <td class="hidden-xs">{{cart.createddate | formatDateWithTimezone}}</td>
                            <td>{{(cart.requestedshipdate || 'N/A') | formatDate}}</td>
                            <td>{{cart.itemcount}}</td>
                            <td>{{cart.subtotal | currency}}</td>
                        </tr>
                      </tbody>
                    </table>
                    <div style="margin: 0 auto; width: 100px;">
                      <a ui-sref="menu.order" 
                      class="btn btn-default pull-right btn-sm"  
                      ng-hide="loadingCarts || cartMessage || cartHeaders.length === 0"
                      ng-if="cartHeaders.length > numCartsToDisplay" 
                      analytics-on analytics-category="Homepage-Pending-Orders-Desktop" 
                      analytics-event="Pending Orders View All">View All</a>
                    </div>
                </tab>
                <tab heading="Confirmed Orders" ng-if="canViewOrders && orders && orders.length > 0" class="text-center">
                  <h3 class="visible-print-block hidden-xs hidden-sm hidden-md hidden-lg">Confirmed Orders</h3>
                    <table class="table item-details__table table-striped-rows no-margin" style="table-layout: fixed;">
                      <tbody>
                        <tr>
                          <th>Invoice Number</th>
                          <th class="hidden-xs">Created Date/Time</th>
                          <th>Delivery Date</th>
                          <th>Subtotal <span tooltip="This is your order total without taxes, fees, and final catch weight prices." class="glyphicon glyphicon-info-sign ico-blue"></span></th>
                          <th>Status</th>
                          <th>Invoice Status</th>
                        </tr>
                        <tr ng-repeat="order in orders | orderBy:'createddate':true | limitTo: numOrdersToDisplay | styleOrders" analytics-on analytics-category="Homepage-Confirmed-Orders-Desktop" analytics-event="Confirmed Orders" ng-class="order.highlightClass">
                            <td order-link></td>
                            <td class="hidden-xs">
                                {{order.createddate | formatDateWithTimezone}}
                            </td>
                            <td ng-if="order.deliverydate != null"><span >{{order.deliverydate | formatDate}}</span><span ng-if="order.deliverydate == null">TBD</span></td>
                            <td>{{order.ordertotal | currency}}</td>
                            <td>{{order.status}}</td>
                                        <!-- Display order status before ETA info is available -->
                            <td ng-if="order.scheduleddeliverytime != null
                            || order.estimateddeliverytime != null
                            || order. actualdeliverytime != null" style="padding:12px 0">
                            <span ng-if="order.estimateddeliverytime != null
                              && order.actualdeliverytime == null
                              && order.deliveryoutofsequence != true">
                              <span class="small-icon icon-truck"></span>
                            <br/>ETA:&nbsp;{{order.estimateddeliverytime | formatDateWithTimezone:'h:mma z'}}
                            </span>
                            <span ng-if="order.actualdeliverytime != null">
                            Delivered<br />{{order.actualdeliverytime | formatDateWithTimezone}}
                          </span>
                            <span ng-if="
                              order.actualdeliverytime == null && (order.estimateddeliverytime == null
                              || order.deliveryoutofsequence == true)">
                            <span class="small-icon icon-truck"></span>
                            <br />Out For Delivery
                            </span>
                          </td>
                          <!-- Display ETA info once it s available -->
                          <td class="table-col highlight-col">
                            {{order.invoicestatus || 'N/A'}}
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <div style="margin: 0 auto; width: 100px;">
                        <a ui-sref="menu.order" 
                          class="btn btn-default pull-right btn-sm"  
                          ng-hide="loadingOrders || ordersMessage || orders.length === 0"
                          ng-if="orders.length > numOrdersToDisplay"
                          analytics-on 
                          analytics-category="Homepage-Confirmed-Orders-Mobile" 
                          analytics-event="Confirmed Orders View All">
                          View All
                        </a>
                    </div>
                </tab>
              </tabset>
            </div>
          </div>
      
    <div class="row">

    <!-- Recommendations -->
    <div class="col-xs-12" 
      ng-if="isOrderEntryCustomer && recommendedItems.length > 0" 
      ng-hide="cartHeaders.length == 0 && recentlyViewedItems.length == 0 && orders.length == 0" >
            <h3>Recommended For You</h3>
            <div loading-spinner="loadingRecommendedItems" ng-show="loadingRecommendedItems"></div>

        <div ng-show="!loadingRecommendedItems && recommendedItems.length > 0">
          <ul class="horizontal-slide hidden-xs hidden-sm" ng-class="{ 'hidden-md' : isMobile == true }">
            <li ng-if="item.name != 'All'" ng-repeat="item in recommendedItems | limitTo: 8" class="item-holder" analytics-on analytics-category="Homepage-Recommended-Items-Desktop" analytics-event="Recommended Items" analytics-label="{{item.itemnumber}}" style="padding-right: 7px;">
              <div class="featured-item text-center">
                <img
                  ng-if="item.category_image"
                  class="hand items"
                  ui-sref="menu.catalog.products.list({ type: 'category', id: item.search_name, category: item.name})"
                  ng-src="{{item.category_image.url}}"
                  alt="product image">
                <img
                  ng-if="!item.category_image"
                  class="product-placeholder-image"
                  ui-sref="menu.catalog.products.list({ type: 'category', id: item.search_name, category: item.name})"
                  src="images/bek-logo.png"
                  alt="default product image">
                <span class="featured-item__detail">
                  <a ui-sref="menu.catalog.products.list({ type: 'category', id: item.search_name, category: item.name})" class="text-uppercase">{{::item.name}}</a>
                </span>
              </div>
            </li>
          </ul>

          <div featured-item-carousel="recommendedItems" catalog="true" template="{{'views/featuredItemTemplates/product.html'}}"></div>
        </div>
        <h4 ng-if="recommendedItems == null || recommendedItems.length === 0">No recommended items to display.</h4>
    </div>
        
    </div>
  </div>
