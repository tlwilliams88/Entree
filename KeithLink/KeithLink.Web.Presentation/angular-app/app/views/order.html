<div page-header-bar>
  <div header-message>
    Order History 
    <button ng-click="refreshOrderHistory()" class="hidden-md hidden-lg btn btn-lg btn-success pull-right">Get Latest Updates</button>
  </div>
  <div header-buttons>
    <button ng-click="refreshOrderHistory()" class="hidden-xs hidden-sm btn btn-lg btn-success">Get Latest Updates</button>
    <button title="Print" class="btn btn-icon btn-default"><span class="icon-printer"></span></button>
    <button title="Export" class="btn btn-icon btn-default"><span class="icon-export"></span></button>
  </div>
</div>

<div class="row">
  <div class="col-xs-12 text-right">
    Showing {{filteredItems.length}} of {{orders.length}} Orders
  </div>
</div>

<table class="table table-border table-striped-rows">
  <thead>
    <tr>
      <th class="sort-col-header" ng-click="sortOrder=!sortOrder;sortBy='ordernumber'">
        Order #
        <span sort-icons field="'ordernumber'" sortorder="sortOrder" sortby="sortBy"></span>
      </th>
      <th class="sort-col-header" ng-click="sortOrder=!sortOrder;sortBy='createddate'">
        Order Date
        <span sort-icons field="'createddate'" sortorder="sortOrder" sortby="sortBy"></span>
      </th>
      <th class="sort-col-header" ng-click="sortOrder=!sortOrder;sortBy='status'">
        Status
        <span sort-icons field="'status'" sortorder="sortOrder" sortby="sortBy"></span>
      </th>
      <th class="sort-col-header hidden-xs hidden-sm" ng-click="sortOrder=!sortOrder;sortBy='deliverydate'">
        Delivery Date
        <span sort-icons field="'deliverydate'" sortorder="sortOrder" sortby="sortBy"></span>
      </th>
      <th class="hidden-xs hidden-sm">Item Count</th>
      <th class="sort-col-header text-right hidden-xs hidden-sm" ng-click="sortOrder=!sortOrder;sortBy='ordertotal'">
        Total
        <span sort-icons field="'ordertotal'" sortorder="sortOrder" sortby="sortBy"></span>
      </th>
      <th class="hidden-xs hidden-sm">Invoice #</th>
      <th class="sort-col-header hidden-xs hidden-sm" ng-click="sortOrder=!sortOrder;sortBy='invoicestatus'">
        Invoice Status
        <span sort-icons field="'invoicestatus'" sortorder="sortOrder" sortby="sortBy"></span>
      </th>
      <th class="large-icon icon-col">
        <a ng-click="showFilter = !showFilter;"><span class="icon-filter"></span></a>
      </th>
    </tr>
  </thead>
  <tbody>

    <!-- Filter Row -->
    <tr class="filter-row" ng-show="showFilter">
      <td class="input-col">
        <input type="text" placeholder="Filter..." ng-model="filterFields.ordernumber">
      </td>
      <td></td>
      <td class="input-col">
        <input type="text" placeholder="Filter..." ng-model="filterFields.status">
      </td>
      <td class="hidden-xs hidden-sm"></td>
      <td class="hidden-xs hidden-sm"></td>
      <td class="hidden-xs hidden-sm"></td>
      <td class="hidden-xs hidden-sm"></td>
      <td class="hidden-xs hidden-sm input-col">
        <input type="text" placeholder="Filter..." ng-model="filterFields.invoicestatus">
      </td>
      <td class="large-icon icon-col">
        <a ng-click="filterFields = {}"><span class="text-light icon-cross3"></span></a>
      </td>
    </tr> <!-- end Filter Row -->

    <tr ng-repeat-start="order in (filteredItems = (orders | filter:filterFields | orderBy:sortBy:sortOrder))" ng-class="{ odd : $odd, even: $even }">
      <td>
        <a ui-sref="menu.orderitems({orderNumber: order.ordernumber})">{{order.ordernumber}}</a>
      </td>
      <td>{{order.createddate | date:'MM/dd/yyyy h:mma'}}</td>
      <td>{{order.status}}</td>
      <td class="hidden-xs hidden-sm">{{order.deliverydate || 'N/A'}}</td>
      <td class="hidden-xs hidden-sm">{{order.itemcount}}</td>
      <td class="hidden-xs hidden-sm text-right">{{order.ordertotal | currency}}</td>
      <td class="hidden-xs hidden-sm">{{order.invoicenumber || 'N/A'}}</td>
      <td class="hidden-xs hidden-sm">{{order.invoicestatus || 'N/A'}}</td>
      <td class="large-icon icon-col">
        <a class="visible-xs visible-sm"><span class="hidden-print text-light icon-ellipsis" ng-click="showDetails = !showDetails;"></span></a>
      </td>
    </tr>
    <tr ng-repeat-end ng-show="showDetails" ng-class="{ odd : $odd, even: $even }" class="mobile-details-row hidden-md hidden-lg">
      <td colspan="4">
        <table>
          <colgroup>
            <col width="25%" />
            <col width="75%" />
          </colgroup>
          <tr>
            <td>Delivery Date</td>
            <td>{{order.deliverydate || 'N/A'}}</td>
          </tr>
          <tr>
            <td>Item Count</td>
            <td>{{order.itemcount}}</td>
          </tr>
          <tr>
            <td>Total</td>
            <td>{{order.ordertotal | currency}}</td>
          </tr>
          <tr>
            <td>Invoice #</td>
            <td>{{order.invoicenumber || 'N/A'}}</td>
          </tr>
          <tr>
            <td>Invoice Status</td>
            <td>{{order.invoicestatus || 'N/A'}}</td>
          </tr>
        </table>
      </td>
    </tr>
  </tbody>
  <tfoot ng-show="orders.length === 0">
    <tr>
      <td>There are no orders to display.</td>
    </tr>
  </tfoot>
</table>