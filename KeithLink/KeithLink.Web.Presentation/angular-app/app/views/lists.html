<div page-header-bar>
  <div header-message>
    <div ng-hide="editingListName">
      <span>{{selectedList.name}}</span>
      <span class="hidden-print header-icons text-light icon-pencil" ng-click="startEditListName(selectedList.name)"></span>  
    </div>

    <form name="renameListForm" class="inline-header-form" ng-show="editingListName">
      <input type="text" ng-required ng-minlength="3" ng-model="editList.name" />
      <button ng-disabled="renameListForm.$invalid" class="no-style" type="submit" ng-click="renameList(selectedList.listid, editList.name)"><span class="header-icons text-green icon-checkmark"></span></button>
      <span class="header-icons text-red icon-cross" ng-click="cancelEditListName()"></span>
    </form>
  </div>
  <div header-buttons>
    <button class="btn btn-icon" ng-click="print()"><span class="icon-printer"></span></button>
    <button class="btn btn-icon"><span class="icon-disk"></span></button>
  </div>
</div>

<div class="row">
  <!-- Available Lists -->
  <div class="col-sm-2 hidden-xs hidden-sm hidden-print search-results__filters">
    <div class="row">
      <div class="col-sm-12 custom-lists">
        <h3>Your Lists</h3>

        <div class="btn-group-vertical list-names text-blue">
          <button ng-click="goToList()" class="btn btn-list">All Items (Favorites)</button>
          <button ng-repeat="list in lists | limitTo: itemsLimit()" ng-click="goToList(list)" class="btn btn-list" data-drop="true" data-jqyoui-options="{hoverClass:'bek-drag-hover',tolerance:'pointer',activeClass:'bek-drag-active'}" jqyoui-droppable="{onDrop: 'addItemToList(list)'}">{{list.name}}</button>
        </div>
        <p class="custom-lists__more">
          <a ng-show="hasMoreItemsToShow()" ng-click="showMore()">Show More...</a>
          <a href=""></a>
        </p>
        
        <button ng-click="createList()" data-drop="true" data-jqyoui-options="{hoverClass:'bek-drag-hover',tolerance:'pointer',activeClass:'bek-drag-active'}" jqyoui-droppable="{onDrop: 'createList()'}" class="btn btn-list text-light">Create A List</button>
        
        <div class="trash-wrapper" data-drop="true" data-jqyoui-options="{hoverClass:'bek-drag-hover',tolerance:'pointer',activeClass:'bek-drag-active'}" jqyoui-droppable="{onDrop: 'deleteItem(selectedList)'}">
        <button class="btn btn-icon btn-trash"><span class="icon-trash"></span></button>
        </div>

      </div>
    </div>
  </div>

  <!-- Items in List -->
  <div class="col-md-10 col-xs-12">
    
    <div>
      <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>
    </div>

    <form name="listSearchForm" class="hidden-print search-form" novalidate>
      <div class="input-group">
        <input required ng-minlength="3" ng-model="listSearchForm" type="text" class="form-control" placeholder="Search by keyword, item # or label">
        <span class="input-group-btn">
        <button ng-disabled="listSearchForm.$invalid" class="btn cta-btn" type="submit"><span class="icon-search"></span> SEARCH</button>
        </span>
      </div>
    </form>
    
    <table class="table table-striped table-details">
      <thead>
        <tr>
          <th></th>
          <th>
            Item #
          </th>
          <th class="hidden-sm hidden-xs">
            Pack / Size
          </th>
          <th>
            Description
          </th>
          <th>
            Label
          </th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr style="cursor:move;" ng-repeat-start="product in selectedList.items" data-drag="true" data-jqyoui-options="{helper:'clone', cursorAt: { top: -5, left: -5 }}" jqyoui-draggable="{onStart: 'selectItem(product)'}">
          <td class="text-light table-icon hidden-drag">
            <span class="icon-list2" style="cursor:move;"></span>
            <span class="icon-star2" ng-click="addSavedItem(product)"></span>
            <!-- <span style="color:gold;" class="icon-star" ng-click="removeSavedItem(product)"></span> -->
          </td>
          <td>
            <a ui-sref="menu.catalog.products.details({ itemNumber : product.productid, item: product })">{{product.productid}}</a>
          </td>
          <td class="hidden-sm hidden-xs">
            {{product.cases}} / {{product.size}}
          </td>
          <td>
            {{product.name}}
          </td>
          <td class="table-dropdown hidden-drag">
            <div class="select-div hidden-print">
              <select ng-change="updateItemLabel(product)" name="" id="" ng-model="product.label" ng-options="label for label in labels">
                <option value="">Select A Label...</option>
              </select>
            </div>
            <span class="visible-print">{{product.label}}</span>
          </td>
          <td class="table-icon hidden-drag">
            <a class="hidden-print" ng-mouseleave="hideContextMenu()" ng-mouseenter="showContextMenu($event, this)"><span class="icon-plus2"></span></a>
            <span class="hidden-print text-light visible-xs-inline visible-sm-inline icon-ellipsis" ng-click="showDetails = !showDetails;"></span>
          </td>
        </tr>
        <tr ng-repeat-end ng-show="showDetails" class="search-results__details">
          <td colspan="5">
            <div>
              <p>Pack / Size: {{product.cases}} / {{product.size}}</p>
              <p>Brand: {{product.brand}}</p>
            </div>
          </td>
        </tr>
        <tr ng-show="selectedList.items.length === 0">
          <td colspan="7">No products found.</td>
        </tr>
      </tbody>
    </table>

    <div class="text-center sub-content" loading-spinner="loadingResults"></div>
  </div>
</div>

<!-- Context Menu -->
<div class="context-menu btn-group-vertical" ng-show="isContextMenuDisplayed">
  <button ng-click="addSavedItem(product)" class="btn text-uppercase">In saved items</button>
  <div ng-mouseenter="status.isopen1 = true;" ng-mouseleave="status.isopen1 = false;" class="btn-group" ng-class="{ open: status.isopen1 }">
    <button type="button" class="btn btn-primary dropdown-toggle" ng-disabled="disabled">
      Add to Order<span class="icon-arrow-right6"></span>
    </button>
    <ul class="dropdown-menu" role="menu">
      <div class="btn-group-vertical">
        <button type="button" class="btn">Order 1</button>
        <button type="button" class="btn">Order 2</button>
        <button type="button" class="btn">New Order...</button>
      </div>
    </ul>
  </div>
  <div ng-mouseenter="status.isopen2 = true;" ng-mouseleave="status.isopen2 = false;" class="btn-group" ng-class="{ open: status.isopen2 }">
    <button type="button" class="btn btn-primary dropdown-toggle" ng-disabled="disabled">
      Add to List <span class="icon-arrow-right6"></span>
    </button>
    <ul class="dropdown-menu" role="menu">
      <div class="btn-group-vertical">
        <button ng-repeat="list in lists" type="button" class="btn">{{list.name}}</button>
      </div>
    </ul>
  </div>
</div>
