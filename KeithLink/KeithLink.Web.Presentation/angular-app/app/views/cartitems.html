<div class="row page-header-bar">
  <div class="col-md-7 page-header-bar__message">
    <div ng-hide="currentCart.isRenaming">
      <div class="btn-group" dropdown is-open="status.isopen">
        <button type="button" class="btn btn-default cart-selection-button dropdown-toggle">
          {{currentCart.name}} <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-list-multi-columns ">
          <li>
            <div class="row">
              <div class="col-xs-12">
                <a class="text-regular" ng-click="goToCart(cart)" ng-if="cart.id !== currentCart.id" ng-repeat="cart in carts | orderBy: 'name'">
                  <div class="row">
                    <div class="col-xs-6">
                      {{cart.name}}
                    </div>
                    <div class="col-xs-2">
                      {{cart.items.length}}
                    </div>
                    <div class="col-xs-4">
                      {{cart.requestedshipdate | date:shortDate}}
                    </div>
                  </div>
                </a>
                <a ng-click="createNewCart()">
                  <div class="row">
                    <div class="col-xs-12">
                      Create New Cart...
                    </div>
                  </div>
                </a>
              </div>
            </div>
          </li>
        </ul>
      </div>

      <div style="display:inline-block;">
        <a ng-click="startEditCartName(currentCart.name)"><span class="hidden-print large-icon text-light icon-pencil"></span></a>
        <a confirmed-click="deleteCart(currentCart)" class="hidden-print" ng-confirm-click="{{'This will delete the cart ' + currentCart.name + ' and all items within. Are you sure you want to delete this cart?'}}"><span class="large-icon text-light icon-trash"></span></a>
      </div>
    </div>

    <form name="renameCartForm" class="style-validation-errors inline-header-form" ng-show="currentCart.isRenaming">
      <input check-duplicate-field="name" collection="carts" type="text" max-length="15" focus-me="currentCart.isRenaming" required ng-model="editCart.name" name="cartName" id="cartName" />
      <button ng-disabled="renamecartForm.$invalid" class="btn-no-style" type="submit" ng-click="renameCart(currentCart.id, editCart.name); renameCartForm.$setPristine();"><span class="large-icon text-green icon-checkmark"></span></button>
      <a ng-click="currentCart.isRenaming = false"><span class="large-icon text-red icon-cross"></span></a>
      <span class="form-error-message" ng-show="renameCartForm.cartName.$error.required">Cart name is required</span>
      <span class="form-error-message" ng-show="renameCartForm.cartName.$error.checkDuplicateField">Duplicate cart name</span>
    </form>
  </div>
  <div class="col-md-5 hidden-xs hidden-sm hidden-print page-header-bar__actions">

    <div class="pull-right">
      <div class="page-header__buttons">
        <button class="btn btn-default btn-icon" ng-click="print()"><span class="icon-printer"></span></button>
        <button class="btn btn-default btn-icon"><span class="icon-export"></span></button>
      </div>
      <div class="page-header__orders" ng-if="isOrderEntryCustomer">
        <a ui-sref="menu.cart.items({ cartId: 1 })"><span class="large-icon icon-truck"></span></a>
      </div>
    </div>

  </div>
</div>

<form unsaved-warning-form novalidate name="cartForm" class="style-validation-errors">
<div class="row">
  <div class="col-xs-12 col-sm-9 col-md-7 col-lg-6">
    <div class="cart-info">
      <div class="row cart-info-item">
        <div class="col-sm-5 text-green cart-info-subtotal">
          {{getSubtotal(currentCart.items) | currency}}
        </div>
        <div class="col-sm-7 cart-info-buttons">
          <button class="btn text-light btn-primary" type="submit" ng-disabled="cartForm.$pristine" ng-click="saveCart(currentCart)">Save Cart</button>
          <button class="btn btn-primary" ng-disabled="cartForm.$invalid || !currentCart.items || currentCart.items.length === 0">Submit Order</button>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <p class="text-red no-margin" ng-show="cartForm.$invalid && !cartForm.$pristine">Your cart has some errors. Please fix these before submitting your order.</p>
        </div>
      </div>
      <div class="row sub-content cart-info-item cart-info-item__ship-date">
        <div class="col-sm-6 col-sm-5">
          <strong>Ship Date</strong>
        </div>
        <div class="col-sm-6">
          <p class="input-group datepicker-input">
            <input type="text" required class="form-control datepicker" datepicker-popup="" ng-disabled="true" ng-model="currentCart.requestedshipdate" is-open="datepicker.opened" datepicker-options="dateOptions" ng-required="true" close-text="Close" />
            <span class="input-group-btn">
              <button type="button" class="btn btn-default" ng-click="openDatepicker($event)"><i class="glyphicon glyphicon-calendar"></i></button>
            </span>
          </p>
        </div>
      </div>
      <div class="row cart-info-item">
        <div class="col-sm-6 col-sm-5">
          <strong>Earliest Order Date:</strong>
        </div>
        <div class="col-sm-6 text-light">
          5pm CST 9-28-14
        </div>
      </div>
      <div class="row cart-info-item">
        <div class="col-sm-6 col-sm-5">
          <strong>Submit by:</strong>
        </div>
        <div class="col-sm-6 text-light">
          5pm CST 9-27-14
        </div>
      </div>
      <div class="row cart-info-item">
        <div class="col-xs-12">
          <input type="checkbox" ng-model="currentCart.active" name="activeCart" id="activeCart">
          <label for="activeCart" style="font-weight:normal;">Make this my Active Cart</label>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    

    <div class="bootstrap-table cart__table sub-content" navigate-table>
      <div class="text-right">
      Showing {{filteredItems.length}} of {{currentCart.items.length}} Items in Cart
      </div>

      <!-- Header row -->
      <div class="row table-header">
        <div class="col-xs-12">
          <div class="row table-row table-row-data">
            <div class="col-md-1 col-xs-2 hand nowrap" ng-click="sortBy='itemnumber';sortOrder=!sortOrder;">
              Item #
              <span sort-icons field="'itemnumber'" sortorder="sortOrder" sortby="sortBy"></span>
            </div>
            <div class="col-md-1 hidden-xs hidden-sm hand nowrap" ng-click="sortBy='notes';sortOrder=!sortOrder">
              Notes
              <span sort-icons field="'notes'" sortorder="sortOrder" sortby="sortBy"></span>
            </div>
            <div class="col-md-1 hidden-xs hidden-sm">
              Pack/Size
            </div>
            <div class="col-md-1 hidden-xs hidden-sm hand nowrap" ng-click="sortBy='brand';sortOrder=!sortOrder">
              Brand
              <span sort-icons field="'brand'" sortorder="sortOrder" sortby="sortBy"></span>
            </div>
            <div class="col-md-2 col-xs-6 hand nowrap" ng-click="sortBy='name';sortOrder=!sortOrder">
              Name
              <span sort-icons field="'name'" sortorder="sortOrder" sortby="sortBy"></span>
            </div>
            <div class="col-md-1 hidden-xs hidden-sm">
              
            </div>
            <div class="col-md-1 col-xs-2 hand nowrap" ng-click="sortBy='quantity';sortOrder=!sortOrder">
              Qty
              <span sort-icons field="'quantity'" sortorder="sortOrder" sortby="sortBy"></span>
            </div>
            <div class="col-md-1 hidden-xs hidden-sm hand nowrap" ng-click="sortBy='each';sortOrder=!sortOrder">
              Each
              <span sort-icons field="'each'" sortorder="sortOrder" sortby="sortBy"></span>
            </div>
            <div class="col-md-1 hidden-xs hidden-sm hand nowrap" ng-click="sortBy='price';sortOrder=!sortOrder">
              Price
              <span sort-icons field="'price'" sortorder="sortOrder" sortby="sortBy"></span>
            </div>
            <div class="col-md-1 hidden-xs hidden-sm hand nowrap">
              Ext Price
            </div>
            <div class="col-xs-1 table-col-icons">
              <a ng-click="showFilter = !showFilter;"><span class="icon-filter"></span></a>
              
            </div>
          </div>
        </div>
      </div> <!-- end Header row -->

      <div class="table-body row" ng-hide="(currentCart.items.length === 0 || !currentCart.items) && currentCart" infinite-scroll="infiniteScrollLoadMore()" infinite-scroll-distance="2">
        <div class="col-xs-12">
          
          <!-- Filter row -->
          <div class="row table-row filter-row" ng-show="showFilter">
            <div class="col-md-1 col-xs-2">
              
            </div>
            <div class="col-md-1 table-col-input hidden-xs hidden-sm">
              <input name="filterNotes" no-dirty-check type="text" placeholder="Filter..." ng-model="filterFields.notes">
            </div>
            <div class="col-md-1 hidden-xs hidden-sm">
              
            </div>
            <div class="col-md-1 table-col-input hidden-xs hidden-sm">
              <input name="filterBrands" no-dirty-check type="text" placeholder="Filter..." ng-model="filterFields.brand">
            </div>
            <div class="col-md-2 col-xs-6 table-col-input">
              <input name="filterName" no-dirty-check type="text" placeholder="Filter..." ng-model="filterFields.name">
            </div>
            <div class="col-md-1 hidden-xs hidden-sm">
            </div>
            <div class="col-md-1 col-xs-2">
              
            </div>
            <div class="col-md-1 hidden-xs hidden-sm">
              
            </div>
            <div class="col-md-1 hidden-xs hidden-sm">
              
            </div>
            <div class="col-xs-1 hidden-xs hidden-sm">
              
            </div>
            <div class="col-xs-1 table-col-icons">
              <a ng-click="filterFields = {}"><span class="text-light icon-cross3"></span></a>
            </div>
          </div> <!-- end Filter row -->

          <!-- Data rows -->
          <div 
            class="row table-row"  
            ng-class="{ odd : $odd, even: $even }" 
            ng-repeat="item in (filteredItems = (currentCart.items | filter:filterFields | orderBy:sortBy:sortOrder | limitTo:itemsToDisplay)) track by item.cartitemid"
           >
            <div class="col-xs-12">
              <div class="row table-row-data">
                <div class="table-cell col-md-1 col-xs-2">
                  <a ui-sref="menu.catalog.products.details({ itemNumber : item.itemnumber })">{{item.itemnumber}}</a>
                </div>
                <div class="table-cell col-md-1 table-col-input hidden-xs hidden-sm">
                  <ng-form class="hidden-print" name="notesForm">
                    <input id="notes" name="notes" type="text" ng-model="item.notes" />
                  </ng-form>
                </div>
                <div class="table-cell col-md-1 hidden-sm hidden-xs">
                  {{item.packsize}}
                </div>
                <div class="table-cell col-md-1 hidden-sm hidden-xs">
                  {{item.brand}}
                </div>
                <div class="table-cell col-md-2 col-xs-6">
                  {{item.name}}
                </div>
                <div class="table-cell col-md-1 hidden-sm hidden-xs" item-icons>
                </div>
                <div class="table-cell col-md-1 table-col-input col-xs-2">
                  <ng-form class="hidden-print" name="quantityForm">
                    <input name="quantity" required style="width: 55px;" type="text" ng-model="item.quantity" class="text-right" integer>
                  </ng-form>
                </div>
                <div class="table-cell col-md-1 hidden-sm hidden-xs table-col-input">
                  <ng-form name="eachForm" ng-if="item.packageprice !== '0'">
                      <input type="checkbox" ng-model="item.each" id="each" name="each" />
                      <label for="each"></label>
                  </ng-form>
                </div>
                <div class="table-cell col-md-1 hidden-sm hidden-xs">
                  {{item.each ? item.packageprice : item.caseprice | currency}}
                </div>
                <div class="table-cell col-md-1 hidden-sm hidden-xs">
                  {{(item.quantity * (item.each ? item.packageprice : item.caseprice) || 0) | currency}}
                </div>
                <div class="table-cell col-xs-1 table-col-icons">
                  <a class="visible-xs-inline visible-sm-inline"><span class="hidden-print text-light visible-xs-inline visible-sm-inline icon-ellipsis" ng-click="showDetails = !showDetails;"></span></a>
                  <a ng-click="deleteItem(item)"><span class="text-red icon-cross"></span></a>
                </div>
                
              </div>

              <!-- Mobile Details -->
              <div class="row" ng-show="showDetails">
                <div class="col-xs-12">
                  <ng-form class="hidden-print" name="notesForm_mobile">
                    Notes:
                    <input clas="form-control" id="notes" name="notes" type="text" ng-model="item.notes" />
                  </ng-form>
                  <p>Pack/Size: {{item.packsize}}</p>
                  <p>Brand: {{item.brand}}</p>
                  <p item-icons></p>
                  <p ng-if="item.packageprice !== '0'">
                    <!-- <div class="checkbox"> -->
                      <label for="each">Each</label>
                      <input type="checkbox" value="" name="each" id="each" ng-model="item.each">
                    <!-- </div> -->
                  </p>
                  <p>Price: {{item.each ? item.packageprice : item.caseprice | currency}}</p>
                  <p>Ext Price: {{item.quantity * (item.each ? item.packageprice : item.caseprice) | currency}}</p>
                </div>  
              </div> <!-- end Mobile details -->
            </div>
          </div> <!-- end Data rows -->
        </div>
      </div>

      <div class="row table-footer">
        <div class="col-xs-12">
          <div class="row table-row table-row-data" ng-show="(currentCart.items.length === 0 || !currentCart.items || filteredItems.length === 0) && currentCart">
            <div class="col-xs-12">
              There are no products to display.
            </div>
          </div>
        </div>
      </div> <!-- end Footer row -->
    </div> <!-- end table -->
    <div class="text-center sub-content" loading-spinner="loadingResults"></div>
  </div>
</div>
</form>